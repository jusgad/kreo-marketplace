# Database
DATABASE_URL=postgresql://kreo:kreo_dev_password@localhost:5432/kreo_db

# Redis
REDIS_URL=redis://localhost:6379

# Elasticsearch
ELASTICSEARCH_URL=http://localhost:9200

# JWT (✅ SEGURIDAD: Generar con openssl rand -base64 32)
# Access Token (vida corta: 15 minutos para mejor seguridad)
JWT_ACCESS_SECRET=CAMBIAR-POR-SECRET-GENERADO-CON-OPENSSL-RAND-BASE64-32
JWT_ACCESS_EXPIRES_IN=15m

# Refresh Token (vida larga: 7 días)
JWT_REFRESH_SECRET=CAMBIAR-POR-OTRO-SECRET-DIFERENTE-GENERADO-CON-OPENSSL
JWT_REFRESH_EXPIRES_IN=7d

# Compatibilidad con código antiguo (eliminar cuando migres a JWT_ACCESS_SECRET)
JWT_SECRET=your_jwt_secret_here_change_in_production
JWT_EXPIRES_IN=7d

# Stripe
STRIPE_SECRET_KEY=sk_test_your_stripe_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret
STRIPE_PUBLISHABLE_KEY=pk_test_your_publishable_key

# AWS
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_S3_BUCKET=kreo-marketplace-products

# SendGrid
SENDGRID_API_KEY=your_sendgrid_key
SENDGRID_FROM_EMAIL=noreply@kreo.com

# Twilio
TWILIO_ACCOUNT_SID=your_twilio_sid
TWILIO_AUTH_TOKEN=your_twilio_token
TWILIO_PHONE_NUMBER=+1234567890

# Shippo
SHIPPO_API_KEY=your_shippo_key

# Frontend URLs
CUSTOMER_APP_URL=http://localhost:5173
VENDOR_PORTAL_URL=http://localhost:5174

# API Gateway
API_GATEWAY_URL=http://localhost:3000

# =============================================================================
# ✅ CONFIGURACIÓN DE SEGURIDAD (Parches Aplicados)
# =============================================================================

# Entorno (development, production, test)
NODE_ENV=development

# Session Secret (para express-session)
SESSION_SECRET=CAMBIAR-POR-SECRET-GENERADO-CON-OPENSSL

# Redis (ya configurado arriba, pero asegúrate de tener password en producción)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# CORS - URLs permitidas en producción (separadas por comas)
ALLOWED_ORIGINS=https://tuapp.com,https://www.tuapp.com,https://vendor.tuapp.com

# Rate Limiting
ENABLE_RATE_LIMITING=true
LOGIN_RATE_LIMIT_MAX=5
LOGIN_RATE_LIMIT_WINDOW=60
REGISTER_RATE_LIMIT_MAX=3
REGISTER_RATE_LIMIT_WINDOW=3600

# Seguridad adicional
IP_BLOCK_DURATION=3600
MAX_FAILED_ATTEMPTS=10

# =============================================================================
# ✅ LOGGING Y CLEANUP DE LOGS
# =============================================================================

# Directorio de logs (en producción, usar ruta absoluta)
LOGS_DIR=./logs

# Nivel de logging (error, warn, info, http, debug)
LOG_LEVEL=info

# Retención de logs (formato: Xd para días)
# Los logs se eliminan automáticamente después del periodo especificado
ERROR_LOGS_RETENTION=30d       # Logs de errores: 30 días
COMBINED_LOGS_RETENTION=14d    # Logs combinados: 14 días
HTTP_LOGS_RETENTION=7d         # Logs de HTTP: 7 días

# Tamaño máximo de archivo de log antes de rotar (formato: XMB o XKB)
MAX_LOG_FILE_SIZE=20m          # 20 MB por archivo

# =============================================================================
# INSTRUCCIONES DE INSTALACIÓN DE PARCHES
# =============================================================================
# 1. Genera secrets seguros ejecutando:
#    openssl rand -base64 32
#
# 2. Copia este archivo a .env:
#    cp .env.example .env
#
# 3. Reemplaza todos los valores "CAMBIAR-POR-*" con secrets generados
#
# 4. Instala dependencias de seguridad:
#    cd services/auth-service && npm install
#
# 5. Inicia Redis (necesario para rate limiting):
#    redis-server
#    # O con Docker: docker run -d -p 6379:6379 redis:alpine
#
# 6. Ejecuta el script de verificación:
#    ./shared/security/verificar-parches.sh
#
# 7. NUNCA commitees el archivo .env al repositorio
# =============================================================================
